<!DOCTYPE html>
<html>
<head>
<title>Karel Reader</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<link rel="shortcut icon" href="../../favicon.ico" />
<script src="../../plugins/jquery.min.js"></script>

<link rel="stylesheet" href="../../plugins/bootstrap/css/bootstrap.min.css" />
<script src="../../plugins/bootstrap/js/bootstrap.min.js"></script>

<link rel="stylesheet" href="../../style.css" />

<script src="../../karel/js/html/websiteImports.js"></script>
<script>importCss();</script>
<script>importJs();</script>
</head>
<body>
  <!-- container -->
  <div class="bookContainer">
<!-- side bar -->
<div class="bookSideBar">
  <div class="homeLink">
    <a href="../../python/en/intro.html">
      <span class="glyphicon glyphicon-home" aria-hidden="true"></span>
      Karel
    </a>
  </div>
  <hr/>

  <div class="chapterTab" onclick="location.href='../../python/en/chapter1.html'">
    <a class="bookLink btn btn-link" href="../../python/en/chapter1.html">
      1 - Meet Karel
    </a>
  </div>
  <div class="chapterTab" onclick="location.href='../../python/en/chapter2.html'">
    <a class="bookLink btn btn-link" href="../../python/en/chapter2.html">2 - Programming</a>
  </div>
  <div class="chapterTab" onclick="location.href='../../python/en/chapter3.html'">
    <a class="bookLink btn btn-link" href="../../python/en/chapter3.html">3 - New Functions</a>
  </div>
  <div class="chapterTab" onclick="location.href='../../python/en/chapter4.html'">
    <a class="bookLink btn btn-link" href="../../python/en/chapter4.html">4 - Decomposition</a>
  </div>
  <div class="chapterTab" onclick="location.href='../../python/en/chapter5.html'">
    <a class="bookLink btn btn-link" href="../../python/en/chapter5.html">5 - For Loops</a>
  </div>
  <div class="chapterTab" onclick="location.href='../../python/en/chapter6.html'">
    <a class="bookLink btn btn-link" href="../../python/en/chapter6.html">6 - While Loops</a>
  </div>
  <div class="chapterTab" onclick="location.href='../../python/en/chapter7.html'">
    <a class="bookLink btn btn-link" href="../../python/en/chapter7.html">7 - Conditionals</a>
  </div>
  <div class="chapterTab" onclick="location.href='../../python/en/chapter8.html'">
    <a class="bookLink btn btn-link" href="../../python/en/chapter8.html">8 - Refinement</a>
  </div>
  <div class="chapterTab" onclick="location.href='../../python/en/chapter9.html'">
    <a class="bookLink btn btn-link" href="../../python/en/chapter9.html">9 - Extra Features</a>
  </div>

  <div class="chapterTab" onclick="location.href='../../python/en/reference.html'">
    <a class="bookLink btn btn-link" href="../../python/en/reference.html">10 - Reference</a>
  </div>

  <div class="chapterTab" onclick="location.href='../../python/en/ide.html'">
    <a class="bookLink btn btn-link" href="../../python/en/ide.html">11 - Code</a>
  </div>

  <hr/>

  <!--<a href="../../"><img style = "width:40px" src="../../images/unFlag.png"/> Learn more</a> -->

  <!-- <center>
    <img style ="width:75px;" src="../../images/stanford.png"/>
    </center> -->
</div>
    <!-- content -->
    <div class="bookContent" style="display: flex;">
      <!-- right gutter -->
      <div style="flex-grow:1;max-width:50px;"></div>

      <!-- main stuff -->
      <div class="" style="flex-basis:740px; max-width:740px; margin-left:20px; margin-right:20px">
      <div class="row">
        <div class="col-md-12 col-xs-12">

<h1>Chapter 4: Decomposition</h1>
<hr/>
<p>
  As a way of illustrating more of the power that comes with being able to define new functions, it’s useful to have Karel do something a little more practical than move a beeper from one place to another. The roadways often seem to be in need of repair, and it might be fun to see if Karel can fill potholes in its abstract world. For example, imagine that Karel is standing on the “road” shown in the left-hand figure, one corner to the left of a pothole in the road. Karel’s job is to fill the hole with a beeper and proceed to the next corner. The diagram on the right illustrates how the world should look after the program execution.
</p>


<div class="section" id="ba">
    <div id ='baIde' class = "ide getStarted">
         <div id = 'baCanvasDiv' class = 'commandCanvasDiv'>
          <div>
            <div class="commandCanvasTitle">Before:</div>
            <div class="commandCanvasOuter">
              <canvas id='baCanvasBefore' style="width:300px;" aria-label=" " role="img"></canvas>
            </div>
          </div>
          <div style="width:50px"></div>
          <div>
            <div class="commandCanvasTitle">After:</div>
            <div class="commandCanvasOuter">
              <canvas id='baCanvasAfter' style="width:300px;" aria-label=" " role="img"></canvas>
            </div>
          </div>
         </div>
    </div>

<script>



function exampleba() {
 var karelIde = null;
 var buttonState = 'play';
 var canvas = null;

 function main() {
    canvas = document.getElementById('baCanvasBefore');
    karelIde = KarelIde('python',null, canvas, 'pothole', 0.0, 'en',1000, 0.82 * 1000, console.log, console.log, 'There are walls around row 1 column 1 and in a rectangle near the bottom right corner around the positions in row 1 columns 3, 4, and 5.', setBeforeAriaLabel);

    let canvasGoal = document.getElementById('baCanvasAfter');
    let goalIde = KarelIde('python',null, canvasGoal, 'potholeGoal',0.0, 'en',  1000, 0.82 * 1000, console.log, console.log, 'There are walls around row 1 column 1 and in a rectangle near the bottom right corner around the positions in row 1 columns 3, 4, and 5.', setAfterAriaLabel);
 }

 function setBeforeAriaLabel(altText) {
   $('#baCanvasBefore').attr('aria-label', altText); // set alt text for canvas element
 }

 function setAfterAriaLabel(altText) {
   $('#baCanvasAfter').attr('aria-label', altText); // set alt text for canvas element
 }


 main()

}
exampleba();
    </script>
</div>

<p>
If you are limited to the four predefined commands, the <code>main()</code> function to solve this problem would look like this:
</p>

<p style="margin-left:2em">
  <code><span class="keyword">def</span> main():</code><br/>
    <code style="margin-left:2em">move()</code><br/>
    <code style="margin-left:2em">turn_left()</code><br/>
    <code style="margin-left:2em">turn_left()</code><br/>
    <code style="margin-left:2em">turn_left()</code><br/>
    <code style="margin-left:2em">move()</code><br/>
    <code style="margin-left:2em">put_beeper()</code><br/>
    <code style="margin-left:2em">turn_left()</code><br/>
    <code style="margin-left:2em">turn_left()</code><br/>
    <code style="margin-left:2em">move()</code><br/>
    <code style="margin-left:2em">turn_left()</code><br/>
    <code style="margin-left:2em">turn_left()</code><br/>
    <code style="margin-left:2em">turn_left()</code><br/>
    <code style="margin-left:2em">move()</code><br/>
</p>

<p>
The initial motivation for defining the <code>turn_right()</code> function was that it was cumbersome to keep repeating three <code>turn_left()</code> commands to accomplish a right turn. Defining new functions has another important purpose beyond allowing you to avoid repeating the same command sequences every time you want to perform a particular task. The power to define functions unlocks the most important strategy in programming—the process of breaking a large problem down into smaller pieces that are easier to solve. The process of breaking a program down into smaller pieces is called <b>decomposition</b>, and the component parts of a large problem are called <b>subproblems</b>.
</p>

<p>
  As an example, the problem of filling the hole in the roadway can be decomposed into the following subproblems:
</p>

<ol>
<li> Move up to the hole
<li> Fill the hole by dropping a beeper into it
<li> Move on to the next corner
</ol>

<p>
  If you think about the problem in this way, you can use function definitions to create a program that reflects your conception of the program structure. The main function would look like this:
  </p>

<p style="margin-left:2em">
<code><span class="keyword">def</span> main():</code><br/>
   <code style="margin-left:2em">move()</code><br/>
   <code style="margin-left:2em">fill_pothole()</code><br/>
   <code style="margin-left:2em">move()</code><br/>
</p>

<p>
The correspondence with the outline is immediately clear, and everything would be great if only you could get Karel to understand what you mean by <code>fill_pothole()</code>. Given the power to define functions, implementing <code>fill_pothole()</code> is extremely simple. All you have to do is define a <code>fill_pothole()</code> function whose body consists of the commands you have already written to do the job, like this:
</p>

<p style="margin-left:2em">
<code><span class="keyword">def</span> fill_pothole():</code><br/>
   <code style="margin-left:2em">turn_right()</code><br/>
   <code style="margin-left:2em">move()</code><br/>
   <code style="margin-left:2em">put_beeper()</code><br/>
   <code style="margin-left:2em">turn_around()</code><br/>
   <code style="margin-left:2em">move()</code><br/>
   <code style="margin-left:2em">turn_right()</code><br/>
</p>

<p>
Here is the complete program. Notice how you can understand the programmer's intent simply from reading the <code>main()</code> function. When you run the program, the line highlighting shows how a computer will execute it, step by step. However, because the program is nicely broken down we can understand it on a human thought level:
</p>


<div class="section embeddedIde" id="pothole">
    <div id ='potholeIde' class = "ide getStarted" style="height:516.2px">
      <div id = 'potholeIdeCenter' class = "ideCenter" >
         <div id = 'potholeEditorDiv' class = 'ideEditorDiv' style="width:200px"></div>
         <div id = 'potholeCanvasDiv' class = 'ideCanvasDiv'>
            <canvas id='potholeCanvas' class = 'ideCanvas'></canvas>
            <div id='potholeTextDescriptionBox' class='ideTextDescriptionBox' style="display: none;">
              <p id='potholeInitialWorldDescription'></p>
              <ul id='potholeMovesList'></ul>
            </div>
         </div>
      </div>
    </div>
    <div style="width:100%;">
        <div class="buttonBar">
           <button class="btn btn-default" id="potholeRunButton"><span class="glyphicon glyphicon-play"></span> Run Program</button>
           <button class="btn btn-default" id="potholeTextDescriptionButton">Show Text Descriptions</button>
        </div>
    </div>
<script>



  function examplepothole() {
    STARTER_CODE = `
from karel.stanfordkarel import *
def main():
   move()
   fill_pothole()
   move()

# Fills the pothole beneath Karel's current position by
# placing a beeper on that corner. For this function to work
# correctly, Karel must be facing east immediately above the
# pothole. When execution is complete, Karel will have
# returned to the same square and will again be facing east.
def fill_pothole():
   turn_right()
   move()
   put_beeper()
   turn_around()
   move()
   turn_right()

# Turns Karel 90 degrees to the right.
def turn_right():
   turn_left()
   turn_left()
   turn_left()

# Turns Karel around 180 degrees.
def turn_around():
   turn_left()
   turn_left()    `
    // because of that extra endline at the start of the string
    STARTER_CODE = STARTER_CODE.trim();

    var karelIde = null;
    var karelEditor = null;
    var buttonState = 'play';
    var showTextDescription = false;

    function main() {
      karelEditor = importPythonEditor('potholeEditor','potholeEditorDiv', STARTER_CODE, false);
      //importRunButtonBar('example1ButtonBar');

      $("[title]").tooltip({ position: "bottom center", opacity: 0.9});

      initTabs();
      var canvas = document.getElementById('potholeCanvas');
      karelIde = KarelIde('python',karelEditor, canvas, 'pothole', 0.0, 'en', 1000, 1000, initializeWorldTextDescription, appendMoveDescription, "There are walls around row 1 column 1 and in a rectangle near the bottom right corner around the positions in row 1 columns 3, 4, and 5.");

      $('#potholeRunButton').click(function(){playClicked()});
      $('#potholeTextDescriptionButton').click(function(){toggleTextDescription()});
      onresize();

    }

  function playClicked() {
    if(buttonState == 'play') {
      karelIde.playButton();

      var resetText = '<span class="glyphicon glyphicon-repeat"></span> Reset Program';
      $('#potholeRunButton').html(resetText);
      buttonState = 'reset';
    } else if (buttonState == 'reset') {
      karelIde.stopButton();
      clearMovesList(); // resets text description to description of initial state only
      var playText = '<span class="glyphicon glyphicon-play"></span> Run Program';
      $('#potholeRunButton').html(playText);
      buttonState = 'play';
    }

  }

  function toggleTextDescription() {
    $('#potholeCanvas').toggle();
    $('#potholeTextDescriptionBox').toggle();

    if(!showTextDescription) {
      // text description is currently hidden; toggle button should hide canvas and show text description div
      $('#potholeTextDescriptionButton').text('Show Canvas');
      showTextDescription = true;
    } else {
      // text description is currently showing; toggle button should hide text and show canvas
      $('#potholeTextDescriptionButton').text('Show Text Descriptions');
      showTextDescription = false;
    }
  }

  function initializeWorldTextDescription(worldText) {
    $('#potholeInitialWorldDescription').html(worldText);
  }

  function appendMoveDescription(moveText) {
    $('#potholeMovesList').append(`<li>${moveText}</li>`);
  }

  function clearMovesList() {
    $('#potholeMovesList').empty();
  }

  function onresize() {
    var parentHeight = 516.2;
    var canvasWidth = 200
    var parentWidth = $("#pothole").width();
    console.log('pw: ' + parentWidth);

    var ide = document.getElementById('potholeIde');
    var editorDiv = document.getElementById('potholeEditorDiv');
    var canvas = document.getElementById('potholeCanvasDiv');

    var ideHeight = parentHeight
    var centerHeight = ideHeight;

    var availibleWidth = parentWidth;
    var elementSpacing = 12;

    var editorWidth = availibleWidth - canvasWidth - elementSpacing;

    canvas.style.width = canvasWidth + 'px';
    canvas.style.height = canvasWidth + 'px';
    canvas.style.left = (editorWidth + elementSpacing) + 'px';



    editorDiv.style.left = 0 + 'px'
    editorDiv.style.width = editorWidth + 'px';
    editorDiv.style.height = parentHeight + 'px';
    console.log('editor width: ' + editorWidth)

    if (karelEditor) {
      karelEditor.renderer.onResize();
    }
  }
  main()

  }
  examplepothole();
</script>
</div>
<hr/>
<center>
  <a class="btn btn-primary btn-lg" href="chapter5.html" role="button">Next Chapter</a>
</center>
</p>

<div style="height:60px"></div>        </div>
      </div>

      </div>
      <!-- right gutter -->
      <div style="flex-grow:4"></div>
    </div>
  </div>
</body>
</html>
